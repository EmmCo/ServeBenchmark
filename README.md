
需求：
开发一个http性能压测工具，压测nginx的性能，类似ab，具体要求如下：
1. C语言开发。
2. 程序支持以下参数：线程数、总连接数、并发数。
3. 输出的结果为每秒完成的http连接数。

输入参数如下：
-c 并发连接数目
-t 设置的线程数目
-s 总的连接数目
-r 程序的超时时间 （默认为30s）
-9 使用Http/0.9测试包进行压测
-1 使用Http/1.0测试包进行压测（默认为1.0）
-2 使用Http/1.1测试包进行压测
-k 设置Http 报文 Connection为  Keep-Alive （默认为close）

测试用例：
测试 http://www.qq.com 站点，并发连接数为(-c 500)，线程数为（-t 10），总连接数为（-s 2000），超时时间(-r 50秒)
测试的结果：
工具发起的连接总数为2009，其中成功建立了1997个连接，失败了12例，程序运行时间为37秒，每秒成功连接率为 53。整个过程

总结：
1、传统的压测工具一般的实现是并发数直接等于开辟的进程数( webbench）或者线程数(Siege)，这样模拟并发请求的原理会更加直观，模拟效果在小并发情形下较为准确，但是这种方法在实现单客户端模拟大量并发的情形时效率较为低下，一方面单机开辟的进程数和线程数有限，另一方面大量的进程和线程的上下文切换使程序性能下降较快。
2、另外一种实现方案是指定固定的线程数目进行模拟并发，这种方法的优势在于一个线程可以处理多个套接字，即一个线程可以建立多个连接。同时也减小了CPU上下文次数。但另一方面，这种方案下的线程往往会阻塞在读写IO操作上，从而影响模拟并发的性能。所以不得不降低Socket的读写IO的阻塞时间，但是这样一来就会提高连接失败率，从而导致了因为测试机性能的不足使得压测数据的结果与事实出现了偏差。
